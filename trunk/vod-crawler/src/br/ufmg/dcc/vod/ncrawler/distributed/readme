THIS CODE IS UGLY. redo!